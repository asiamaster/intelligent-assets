<#bs4Body>
<div class="container-fluid">
    <#bs4nav>
    <form id="queryForm" role="form" >
        <div class="row row-cols-6">
            <div class="form-group col">
                <label for="departmentId">部门</label>
                <select id="departmentId" name="departmentId" class="form-control"></select>
                <#bcomboProvider _id="departmentId" _provider="authDepartmentProvider" />
            </div>
            <div class="form-group col">
                <label for="type">入库类型</label>
                <select id="type" name="type" class="form-control">
                    <!-- <option selected >--请选择--</option>
                    <option value="1">整车入库</option>
                    <option value="2">零散入库</option>
                    <option value="3">司磅入库</option> -->
                </select>
                <#bcomboProvider _id="type" _provider="stockInTypeProvider" />
                
            </div>
            <div class="form-group col">
                <label for="categoryId">品类</label>
                <select id="categoryId" name="categoryId" class="form-control" required multiple>
                </select>
                <#bselect2 _id="categoryId" _mode="remote" _optionVariable="categoryAutoCompleteOption" />
            </div>
            <div class="form-group col">
                <label for="state">状态</label>
                
                <select id="state" name="state" class="form-control" >
                </select>
                <#bcomboProvider _id="state" _provider="stockInStateProvider" />
            </div>
            <div class="form-group col">
                <label for="customerName">客户姓名</label>
                <input type="text" class="form-control" name="customerName" id="customerName" maxlength="50"/>
            </div>
            <div class="form-group col">
                <label for="customerCellPhone">手机号</label>
                <input type="text" class="form-control" name="customerCellPhone" id="customerCellPhone" maxlength="50"/>
            </div>
            <div class="form-group col">
                <label for="operatorName">操作员</label>
                <input type="text" class="form-control" name="operatorName" id="operatorName" maxlength="50"/>
            </div>
            <div class="form-group col-auto">
                <label for="createdStart">创建时间</label>
                <div class="form-inline">
                    <div class="input-group">
                        <input type="text" name="createdStart" id="createdStart" class="form-control laydatetime laystart" value="${createdStart!,dateFormat='yyyy-MM-dd HH:mm:ss'}"/>
                        <div class="input-group-append">
                            <label for="createdStart"  class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>&nbsp;&nbsp;至&nbsp;&nbsp;
                    <div class="input-group">
                        <input type="text" name="createdEnd" id="createdEnd" class="form-control laydatetime layend" value="${createdEnd!,dateFormat='yyyy-MM-dd HH:mm:ss'}"/>
                        <div class="input-group-append">
                            <label for="createdEnd"  class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group col-auto">
                <label for="createdStart">到期时间</label>
                <div class="form-inline">
                    <div class="input-group">
                        <input type="text" name="expireStart" id=""expireStart"" class="form-control laydatetime laystart" value="${createdStart!,dateFormat='yyyy-MM-dd HH:mm:ss'}"/>
                        <div class="input-group-append">
                            <label for="createdStart"  class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>&nbsp;&nbsp;至&nbsp;&nbsp;
                    <div class="input-group">
                        <input type="text" name="expireEnd" id="expireEnd" class="form-control laydatetime layend" value="${createdEnd!,dateFormat='yyyy-MM-dd HH:mm:ss'}"/>
                        <div class="input-group-append">
                            <label for="createdEnd"  class="input-group-text fa fa-calendar"></label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col align-self-center mt-3">
                <button id="clear" type="button" class="btn btn-outline-primary mr-2" onclick="javascript:$('#queryForm .form-control').val('');"><i class="fa fa-refresh"></i> 清空</button>
                <button id="query" type="button" class="btn btn-outline-primary" onclick="queryDataHandler()"><i class="fa fa-search"></i> 查询</button>
            </div>
        </div>

    </form>
</#bs4nav>
<hr>
<div class="row">
    <div class="col-12">
        <div id="toolbar" class="btn-group" role="group" aria-label="Toolbar with button groups">
        	<#resource code="addStockIn">
            <button id="btn_view" type="button" class="btn btn-primary" onclick="openAddHandler(1)"><i class="fa fa-truck"></i> 整车入库</button>
            <button id="btn_view" type="button" class="btn btn-primary" onclick="openAddHandler(2)"><i class="fa fa-truck"></i> 零散入库</button>
            <button id="btn_view" type="button" class="btn btn-primary" onclick="openAddHandler(3)"><i class="fa fa-truck"></i> 司磅入库</button>
            </#resource>
            <#resource code="doExport">
            <button id="export" type="button" class="btn btn-primary" onclick="bui.util.doExport('grid','queryForm')"><i class="fa fa-download"></i> 导出</button>
            </#resource>
            <#resource code="viewStockIn">
            <button id="btn_view" type="button" class="btn btn-primary" onclick="openViewHandler()"><i class="fa fa-eye"></i> 查看</button>
			</#resource>
            <#resource code="updateStockIn">
            <button id="btn_edit" type="button" class="btn btn-primary" onclick="openUpdateHandler()"  ><i class="fa fa-pencil-square-o"></i> 修改</button>
       		 </#resource>
        	<#resource code="cancelStockIn">
        	<button id="btn_cancel" type="button" class="btn btn-primary" onclick="openCancelHandler()"><i class="fa fa-ban"></i> 取消</button>
    		</#resource>
   			<#resource code="submitStockIn">
    		<button id="btn_submit" type="button" class="btn btn-primary" onclick="openSubmitHandler()"><i class="fa fa-paper-plane"></i> 提交</button>
			</#resource>
			<!-- <#resource code="payStockIn">
			<button id="btn_submit" type="button" class="btn btn-primary" onclick="openPayHandler()"><i class="fa fa-paypal"></i> 支付</button>
			</#resource> -->
			<#resource code="removeStockIn">
			<button id="btn_withdraw" type="button" class="btn btn-primary" onclick="openWithdrawHandler()"><i class="fa fa-undo"></i> 撤回</button>
			</#resource>
			<#resource code="refundStockIn">
			<button id="btn_refund_apply" type="button" class="btn btn-primary" onclick="openRefundHandler(1)"><i class="fa fa-reply"></i> 退款申请</button>
			</#resource>

</div>
<table id="grid" data-toggle="table" data-title="入库单列表" class="table" data-toolbar="#toolbar" data-pagination="true" data-page-number="1" data-page-size="5"
       data-query-params="queryParams" data-side-pagination="server" data-method="POST" data-content-type="application/x-www-form-urlencoded" data-single-select="true"
       data-click-to-select="true"  data-checkbox-header="true" data-unique-id="id" data-sort-name="id" data-sort-order="desc"  data-icons="bui.variable.icons" data-buttons-class="primary"
       data-show-refresh="true" data-show-fullscreen="true" data-show-columns="true">
    <thead>
    <tr>
        <th data-radio="true"></th>
        <th data-field="code" data-sortable="true" data-align="center" data-width-unit="%" >
            入库单号
        </th>
        <th data-field="type" data-sortable="true" data-align="center" data-sort-name="type" data-provider="stockInTypeProvider">
            入库类型
        </th>
        <th data-field="departmentName" data-sortable="true" data-align="center"  >
            部门
        </th>
        <th data-field="customerName" data-sortable="true" data-sort-name="customer_name" data-align="center">
            客户名称
        </th>
        <th data-field="customerCellphone" data-sortable="true" data-align="center" >
            联系电话
        </th>
        <th data-field="categoryName" data-sortable="true" data-sort-name="category_name" data-align="center">
            货物品类
        </th>
        <th data-field="quantity" data-sortable="true" data-sort-name="quantity" data-align="center">
            总件数
        </th>
        <th data-field="weight" data-sortable="true" data-sort-name="weight" data-align="center">
            总净重
        </th>
        <th data-field="weight" data-sortable="true" data-sort-name="weight" data-align="center">
            单价
        </th>
        <th data-field="amount" data-sortable="true" data-sort-name="total_amount" data-align="center">
            总金额
        </th>
        <th data-field="operatorName" data-sortable="true" data-sort-name="operator_name" data-align="center">
            操作员
        </th>
        <th data-field="createTime" data-sortable="true" data-align="center" data-provider="dateProvider">
            创建日期
        </th>
        <th data-field="stockInDate" data-sortable="true" data-align="center" data-provider="dateProvider">
            入库日期
        </th>
        <th data-field="expireDate" data-sortable="true" data-align="center" data-provider="dateProvider">
            到期日期
        </th>
        <th data-field="state" data-sortable="true" data-align="center" data-sort-name="State" data-provider="stockInStateProvider">
            业务状态
        </th>
        <th data-field="payState" data-sortable="true" data-align="center" data-sort-name="pay_state" >
            收费员
        </th>
        <th data-field="totalAmount" data-sortable="true" data-align="center" data-provider="dateProvider">
            缴费日期
        </th>
    </tr>
    </thead>
</table>
</div>
</div>
</div>
</#bs4Body>
<#stock_indexJs />

<script id="pay" type="text/html">
    <form id="payForm" role="form" novalidate>
        <input type="hidden" class="form-control" name="businessCode" value="{{selectedRow.code}}" required />
        <div class="row row-cols-2">
            <div class="form-group col-12">
                <label for="customerName">客户信息：<i class="red">*</i></label>
                <input  type="text" class="form-control  " name="customerName" value={{selectedRow.customerName}}  required />
            </div>
			<div class="form-group col">
                <label for="_certificateNumber">支付账号：<i class="red">*</i></label>
                <input  type="text" class="form-control" name="payCustomerId" required />
            </div>
			<div class="form-group col">
                <button type="button" class="btn btn-primary" ><i class="fa fa-credit-card"></i>刷卡</button>
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">支付金额：<i class="red">*</i></label>
                <input  type="number" class="form-control" name="amount"  value={{selectedRow.amount}} range="0 9999999" required />
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">输入密码：<i class="red">*</i></label>
                <input id="payPassword" type="password" class="form-control" name="payPassword" required />
            </div>
        </div>
    </form>
</script>


<script id="refund" type="text/html">
    <form id="refundForm" role="form" novalidate>
        <input type="hidden" class="form-control" name="code" value="{{selectedRow.code}}" required />
        <div class="row row-cols-2">
            <div class="form-group col">
                <label for="_info">客户信息：<i class="red">*</i></label>
                <div id="_info" >{{selectedRow.customerName}}   {{selectedRow.customerCellPhone}}</div>
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">可退金额：<i class="red">*</i></label>
                <input id="amount" type="number" class="form-control" value="{{selectedRow.amount}}" name="amount" range="0 9999999" required />
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">退款方式：<i class="red">*</i></label>
                <input id="payType" type="text" class="form-control" name="payType" range="0 9999999" required readonly/>
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">收款人：<i class="red">*</i></label>
                <input id="payUser" type="number" class="form-control " name="payUser" required readonly/>
            </div>
            <div class="form-group col">
                <label for="_certificateNumber">退款原因：<i class="red">*</i></label>
                <textarea  class="form-control" name="notes" placeholder="message"></textarea>
            </div>
        </div>
    </form>
</script>

